# Docker
## 도커

도커(Docker):

리눅스 컨테이너에 여러 기능을 추가함으로써 애플리케이션을 컨테이너로써 좀 더 쉽게 사용할 수 잇게 만들어진 오픈소스 프로젝트

기존에 쓰이던 가상화 방법인 가상 머신과 달리

* 성능의 손실이 거의 없다.
* 차세대 클라우드 인프라 솔루션으로 주목



**도커 관련 프로젝트**

* 도커 컴포즈(Docker Compose)
* 레지스트리(Private Registry)
* 도커 허브(Docker Hub)
* Docker for Desktop

일반적으로 도커라고 하면 도커 엔진(Docker Engine) 의미로 사용된다.

**✔도커 엔진(Docker Engine)**

* 컨테이너를 생성하고 관리하는 주체
* 이 자체로도 컨테이너를 제어가능하며 다양한 기능 제공
* 도커의 주 프로젝트

도커의 생테계에 있는 여러 프로젝트들은 도커 엔진을 효율적으로 사용하기 위한 것

➡  **도커 엔진이 핵심**



### 사용 이유

#### 편리한 애플리케시연 개발과 배포

서버를 부팅할 때 실행되는 운영체제: '호스트 OS'

도커 컨테이너는 호스트 OS위에서 실행되는 격리된 공간

* 따라서 컨테이너 자체에 특별한 권한을 주지 않는 한, 컨테이너 내부의 수정사항이 호스트 OS에 영향을 끼치지 않는다.
* 독립된 개발 환경을 보장받을 수 있다.



컨테이너 내부에서 작업 완료 후 **운영 환경에 배포**하려고 한다

=> 해당컨테이너를 '도커 이미지'로 만들어 운영 서버에 전달하면 된다.

* 도커이미지: 일종의 패키지

**장점**

* 컨테이너에서 사용하던 운영 서버에서 새롭게 패키지 설정 필요없음
* 각종 라이브러리 설치 등으로 인한 의존성 걱정 필요없음
* 서브스를 개발할 때의 환경을 다른 서버에서도 컨테이너도 동이라헥 복제 가능

=> 개발/운영 환경의 통합 가능

=> 도커 이미지는 가상 머신의 이미지와 달리 커널을 포함하지 않아 이미지 크기가 크지 않다.

* 도커의 이미지 내용은 레이어 단위
  * 중복되는 레이어 재사용 가능 => 배포가 매우 빨라진다.

#### 여러 애플리케이션의 독립성과 확성성이 높아진다.

모놀리스(Monolith) 애플리케이션: 소프트웨어의 여러 모듈이 상호 작용하는 로직을 하나의 프로그램 내에서 구동시키는 방식

- 서비스의 기능이 복잡해지고 거대해질수록 소프트웨어 자체의 확장성과 유연성이 줄어든다.

마이크로서비스(Microservices)구조: 여러 모듈을 독립된 형태로 구성

* 언어에 종속되지 않고 변화에 빠르게 대응
* 각 모듈의 관리가 쉬워진다.

✔ 컨테이너는 여러 모듈에게 독립된 환경을 동시에 제공가능 => 마이크로서비스 구조에서 많이 사용하는 가상화 기술



### 아마존 웹 서비스 EC2

AWS(Amazon Web Service)는 클라우드에서 인스턴스를 제공받아 사용하는 EC2(Elastic Computing Cloud) 서비스를 제공한다.

이 서비스를 이용하면 AWS 사이트에서 새로운 인스턴스를 생성해 IP를 할당받아 PuTTY, Xshell 등의 SSH 클라이언트로 해당 서버에 접속해 리눅스 환경를 사용가능하다.

EC2 서비스는 원하는 성능의 서버를 생성해 사용한 시간만큼만 요금을 지불

* 필요할 때마다 간편하게 리눅스 사용가능
* AWS의 모든 서비스는 사용한 만큼 요금을 지불
  * 오랜 기간동안 높은 성능의 서버를 사용시 큰 요즘 지불

EC2를 이용하려면 AWS 계정 필요

**❕ info**

* AWS는 최초 가입 시 월 750시간의 프리티어를 1년간 제공
* AWS EC2의 t2.micro 인스턴스를 무료로 사용가능
* 인스턴스 1개만 사용 시 한 달 내내 켜두어도 요금 발생 X



##  도커 엔진

### 도커 이미지와 컨테이너

도커 엔진에서 사용하는 기본 단위



#### 도커 이미지

컨테이너 생성 시 필요한 요소

가상 머신을 생성할 때 사용하는 iso파일과 유사한 개념

이미지는 여러 개의 계층으로 된 바이너리 파일로 존재

컨테이너를 생성하고 실행할 때 읽기 전용으로 사용

도커 명령어로 내려받을 수 있으므로 별도의 설치 필요 없음



##### 도커에서 사용하는 이미지의 이름

**[저장소 이름]/[이미지 이름]:[태그]**

**✔ 저장소(Repository) 이름**: 이미지가 저장된 장소

* 저장소 이름이 명시되지 않은 이미지는 도커에서 기본적으로 제공하는 이미지 저장소인 도커 허브(Docker Hub)의 공식 이미지
* 이미지 생성 시 저장소 이름 명시를 생략하는 경우도 존재

**✔ 이미지 이름**: 해당 이미지의 역할

* 이미지의 이름은 반드시 설정

* alicek106/ubuntu:14.04
  * 우분투 컨테이너를 생성하기 위한 이미지

**✔ 태그**: 이미지의 버전 관리 혹은 리비전(Revision) 관리에 사용

* alicek106/ubuntu:14.04
  * 14.04와 같이 명시
  * 태그 생량 시 도커 엔진은 이미지의 태그를 lastest로 인식



#### 도커 컨테이너

도커 이미지는 우분투, CentOS 등 기본적인 리눅스 운영체제부터 아파치 웹 서버, MySQL 데이터베이스 등의 각종 애플리케이션, 하둡(Hadoop)이나 스파크(Spark), 스톰(Storm)등의 빅데이터 분석 도구까지 다양한 종류가 존재한다.

이미지로 컨테이너를 생성하면 해당 이미지의 목적에 맞는 파일이 들어 있는 파일시스템과 격리된 시스템 자원 및 네트워크를 사용할 수 있는 독립된 공간이 생성된다.

**=> 도커 컨테이너** 

대부분의 도커 컨테이너는 생성될 때 사용된 도커 이미지의 종류에 따라 알맞은 설정과 파일을 가지고 있어 도커 이미지의 목적에 맞도록 사용되는 것이 일반적이다.

컨테이너는 이미지를 읽기 전용으로 사용하되 이미지에서 변경된 사항만 컨테이너 계층에 저장하므로 원래 이미지에 영향을 주지 않는다. 또한 생성된 각 컨테이너는 각기 독립된 파일시스템을 제공받으며 호스트와 분리돼 있어 특정 컨테이너에서 어떤 애플리케이션을 설치 혹은 삭제하더라도 다른 컨테이너와 호스트에 영향을 주지 않는다.



### 도커 컨테이너 다루기



===========================================================



**Dockerfile과 이미지, 컨테이너 사이 관계**

![image-20221025153605961](C:\Users\multicampus\Desktop\특화\배포관련\Docker.assets\image-20221025153605961.png)

Docker 서비스를 설치하면 docker 명령어를 통해 Dockerfile, 이미지, 컨테이너를 생성하고 구동하는 것이 가능하다.

![image-20221025153838479](C:\Users\multicampus\Desktop\특화\배포관련\Docker.assets\image-20221025153838479.png)

**[참고]** https://whitewing4139.tistory.com/204
